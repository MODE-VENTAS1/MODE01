jQuery(document).ready(function(a){var b,c;a.widget.bridge('uiTooltip',a.ui.tooltip),b=function(){this.settings=tieredPricingTable.settings,this.currencyOptions=tieredPricingTable.currency_options,this.productType=tieredPricingTable.product_type,this.$productQuantityField=a('form.cart').find('[name=quantity]'),this.tieredPriceTableSelector='[data-price-rules-table]',this.is_premium=tieredPricingTable.is_premium==='yes',this.init=function(){this.settings!==void 0&&(this.productType==='variable'&&(a(".single_variation_wrap").on("show_variation",this.loadVariationTable.bind(this)),a(document).on('reset_data',function(){a('[data-variation-price-rules-table]').html('')})),this.settings.display_type==='tooltip'&&this.initTooltip(),this.settings.clickable_table_rows==='yes'&&a(document).on('click',this.tieredPriceTableSelector+' tr',this.setQuantityByClick.bind(this)),this.$productQuantityField.on('change',this.setPriceByQuantity.bind(this)),this.$productQuantityField.trigger('change'))},this.setQuantityByClick=function(d){var b,c;if(!this.is_premium)return;b=a(d.target).closest('tr'),b&&(c=parseInt(b.data('price-rules-amount')),c>0&&this.$productQuantityField.val(c)),this.$productQuantityField.trigger('change')},this.initTooltip=function(){var b=this;this.settings.tooltip_border==='yes'&&a(b.tieredPriceTableSelector).css('border','2px solid '+this.settings.selected_quantity_color),a(document).uiTooltip({items:'.price-table-tooltip-icon',tooltipClass:"price-table-tooltip",content:function(){return a(b.tieredPriceTableSelector)},hide:{effect:"fade"},position:{my:"center bottom-40",at:"center bottom",using:function(b){a(this).css(b)}},close:function(b,a){a.tooltip.innerHTML=''}})},this.setPriceByQuantity=function(){var i,d,c,h,g,b,f,j,e,k,l;if(a('.price-rule-active').removeClass('price-rule-active'),a(this.tieredPriceTableSelector).length>0){i=JSON.parse(a(this.tieredPriceTableSelector).attr('data-price-rules')),d=parseInt(this.$productQuantityField.val()),c=[];for(h in i)i.hasOwnProperty(h)&&c.push(parseInt(h));c=c.sort(function(a,b){return a>b}).reverse();for(g=0;g<c.length;g++)if(b=parseInt(c[g]),f=!1,d>=b){e=parseFloat(a('[data-price-rules-amount="'+b+'"]').data('price-rules-price')),j=a('[data-price-rules-amount='+b+']').find('[data-price-rules-formated-price]').html(),this.changePriceHtml(j),f=!0,a(document).trigger('tiered_price_update',{price:e,quantity:d,__instance:this});break}if(b=f?b:this.getTableMinimum(),k=a('[data-price-rules-amount="'+b+'"]').data('price-rules-price'),this.settings.show_total_price==='yes'&&this.is_premium&&(l=this.formatPrice(d*k),this.changePriceHtml(l,!0)),!f){this.settings.show_total_price!=='yes'&&this.changePriceHtml(this.getDefaultPriceHtml()),a('[data-price-rules-amount='+this.getTableMinimum()+']').addClass('price-rule-active'),e=parseFloat(a('[data-price-rules-amount="'+this.getTableMinimum()+'"]').data('price-rules-price')),a(document).trigger('tiered_price_update',{price:e,quantity:d,__instance:this});return}a('[data-price-rules-amount="'+b+'"]').addClass('price-rule-active')}},this.formatPrice=function(b,f=!0){var c,d,e;return b=this.formatNumber(b,this.currencyOptions.decimals,this.currencyOptions.decimal_separator,this.currencyOptions.thousand_separator),c='<span class="woocommerce-Price-currencySymbol">'+this.currencyOptions.currency_symbol+'</span>',d=f?' %3$s ':'',e='<span class="woocommerce-Price-amount amount">'+this.currencyOptions.price_format+d+'</span>',a('<textarea />').html(e.replace('%2$s',b).replace('%1$s',c).replace('%3$s',this.getPriceSuffix())).text()},this.getPriceSuffix=function(){return typeof tieredPriceTableGetProductPriceSuffix!="undefined"?tieredPriceTableGetProductPriceSuffix():this.currencyOptions.price_suffix},this.formatNumber=function(e,b,f,d){var c,a,g,h,i;return isNaN(b=Math.abs(b))&&(b=2),f==void 0&&(f=","),d==void 0&&(d="."),c=parseInt(e=(+e||0).toFixed(b))+"",(a=c.length)>3?a=a%3:a=0,i=a?c.substr(0,a)+d:"",g=c.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+d),h=b?f+Math.abs(e-c).toFixed(b).replace(/-/,0).slice(2):"",i+g+h},this.getDefaultPriceHtml=function(){return a('[data-price-rules-amount='+this.getTableMinimum()+']').find('[data-price-rules-formated-price]').html()},this.changePriceHtml=function(d,c){c=c!==void 0&&c;var b=a('form.cart').closest('.summary').find('[data-tiered-price-wrapper]');b.length<1&&typeof tieredPriceTableGetProductPriceContainer!="undefined"&&(b=tieredPriceTableGetProductPriceContainer()),c&&b.html(d),b.children('ins').length>0?b.find('ins').html(d):b.find('span:first').html(d)},this.loadVariationTable=function(c,b){a.post(document.location.origin+document.location.pathname+'?wc-ajax=get_price_table',{variation_id:b.variation_id,nonce:tieredPricingTable.load_table_nonce},function(c){a('.price-rules-table').remove(),a('[data-variation-price-rules-table]').html(c),c?this.$productQuantityField.trigger('change'):(this.formatPrice(this.formatPrice(b.display_price),!0),this.$productQuantityField.val(b.min_qty)),this.settings.display_type==='tooltip'&&this.settings.tooltip_border==='yes'&&a(this.tieredPriceTableSelector).css('border','2px solid '+this.settings.selected_quantity_color)}.bind(this))},this.getTableMinimum=function(){var b=a(this.tieredPriceTableSelector).data('minimum');return b=b?parseInt(b):1,b},this.getProductName=function(){return a(this.tieredPriceTableSelector).data('product-name')}},c=new b,c.init()}),function(a){a(document).on('tiered_price_update',function(c,b){a('[data-tier-pricing-table-summary]').removeClass('tier-pricing-summary-table--hidden'),a('[data-tier-pricing-table-summary-product-qty]').text(b.__instance.formatNumber(b.quantity,0)),a('[data-tier-pricing-table-summary-product-price]').html(b.__instance.formatPrice(b.price,!1)),a('[data-tier-pricing-table-summary-total]').html(b.__instance.formatPrice(b.price*b.quantity,!1)),a('[data-tier-pricing-table-summary-product-name]').html(b.__instance.getProductName())}),a(document).on('reset_data',function(){a('[data-tier-pricing-table-summary]').addClass('tier-pricing-summary-table--hidden')}),a(document).on('found_variation',function(){a('[data-tier-pricing-table-summary]').addClass('tier-pricing-summary-table--hidden')})}(jQuery),function(a){a(document).on('found_variation',function(c,b){typeof b.qty_value!="undefined"&&b.qty_value>1&&a('form.cart').find('[name=quantity]').val(b.qty_value)})}(jQuery)